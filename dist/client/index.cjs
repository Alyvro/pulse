"use strict";var l=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var T=(e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})},C=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of y(t))!E.call(e,s)&&s!==n&&l(e,s,{get:()=>t[s],enumerable:!(o=g(t,s))||o.enumerable});return e};var $=e=>C(l({},"__esModule",{value:!0}),e);var O={};T(O,{usePulse:()=>P});module.exports=$(O);var c=require("react");var A=require("nanoid"),D="APWP",p="|";var h=e=>{let t=1,n=0;for(let o=0;o<e.length;o++)t=(t+e.charCodeAt(o))%65521,n=(n+t)%65521;return(n<<16|t).toString(16)};var d=e=>{if(!e.startsWith(D))return null;let t=e.split(p);if(t.length!==8)return null;let[n,o,s,i,a,u,r,f]=t,m=t.slice(0,7).join(p),N=h(m);if(f!==N)return null;try{let S=typeof window>"u"?Buffer.from(r,"base64").toString():atob(r);return{id:i,op:parseInt(s),channel:u,payload:JSON.parse(S),timestamp:parseInt(a,36)}}catch{return null}};var P=(e,t="/api/pulse")=>{let[n,o]=(0,c.useState)(null),[s,i]=(0,c.useState)("CONNECTING");return(0,c.useEffect)(()=>{let a=new EventSource(t);return a.onopen=()=>{},a.onmessage=u=>{let r=d(u.data);r&&(r.op===1?i("CONNECTED"):r.op===3&&r.channel===e&&o(r.payload))},a.onerror=()=>{i("DISCONNECTED"),a.close()},()=>{a.close()}},[e,t]),{data:n,status:s}};0&&(module.exports={usePulse});
//# sourceMappingURL=index.cjs.map